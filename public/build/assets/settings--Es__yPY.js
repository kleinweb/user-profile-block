function S({schema:s}){const[i,t]=wp.element.useState({}),[a,n]=wp.element.useState(!0),[e,p]=wp.element.useState(!1),[r,c]=wp.element.useState(null);wp.element.useEffect(()=>{wp.apiFetch.use(wp.apiFetch.createNonceMiddleware(pluginNameSettings.restNonce)),wp.apiFetch({path:"/plugin-name/v1/settings"}).then(l=>{t(l),n(!1)}).catch(()=>{c({type:"error",message:wp.i18n.__("Failed to load settings.","plugin-name")}),n(!1)})},[]);const g=wp.element.useCallback((l,u)=>{t(o=>({...o,[l]:u}))},[]),m=async()=>{p(!0),c(null);try{await wp.apiFetch({path:"/plugin-name/v1/settings",method:"POST",data:i}),c({type:"success",message:wp.i18n.__("Settings saved.","plugin-name")})}catch{c({type:"error",message:wp.i18n.__("Failed to save settings.","plugin-name")})}p(!1)};return a?React.createElement("div",{style:{padding:"20px",textAlign:"center"}},React.createElement(wp.components.Spinner,null)):React.createElement("div",{className:"plugin-name-settings",style:{maxWidth:"800px",margin:"20px auto"}},React.createElement("h1",null,wp.i18n.__("Plugin Settings","plugin-name")),r&&React.createElement(wp.components.Notice,{status:r.type,isDismissible:!0,onRemove:()=>c(null)},r.message),Object.entries(s).map(([l,u])=>React.createElement(wp.components.Card,{key:l,style:{marginBottom:"20px"}},React.createElement(wp.components.CardHeader,null,React.createElement("h2",{style:{margin:0}},u.label)),React.createElement(wp.components.CardBody,null,Object.entries(u.fields).map(([o,d])=>React.createElement(E,{key:o,fieldKey:o,config:d,value:i[o]??d.default,onChange:w=>g(o,w)}))))),React.createElement(wp.components.Button,{variant:"primary",onClick:m,isBusy:e,disabled:e},e?wp.i18n.__("Saving...","plugin-name"):wp.i18n.__("Save Settings","plugin-name")))}function E({fieldKey:s,config:i,value:t,onChange:a}){const{label:n,description:e,inputType:p,options:r,min:c,max:g}=i;switch(p){case"toggle":case"checkbox":return React.createElement(wp.components.ToggleControl,{label:n,help:e,checked:!!t,onChange:a});case"select":return React.createElement(wp.components.SelectControl,{label:n,help:e,value:String(t),options:Object.entries(r||{}).map(([m,l])=>({value:m,label:l})),onChange:a});case"number":return React.createElement(wp.components.__experimentalNumberControl,{label:n,help:e,value:t,min:c,max:g,onChange:m=>a(Number(m))});case"code":case"textarea":return React.createElement(wp.components.TextareaControl,{label:n,help:e,value:String(t),onChange:a,rows:p==="code"?10:4,style:p==="code"?{fontFamily:"monospace"}:void 0});case"password":return React.createElement(wp.components.TextControl,{label:n,help:e,value:String(t),type:"password",onChange:a});case"url":return React.createElement(wp.components.TextControl,{label:n,help:e,value:String(t),type:"url",onChange:a});default:return React.createElement(wp.components.TextControl,{label:n,help:e,value:String(t),onChange:a})}}document.addEventListener("DOMContentLoaded",()=>{const s=document.getElementById("plugin-name-settings");if(s){const i=s.dataset.settings?JSON.parse(s.dataset.settings):{};wp.element.createRoot(s).render(React.createElement(S,{schema:i}))}});
